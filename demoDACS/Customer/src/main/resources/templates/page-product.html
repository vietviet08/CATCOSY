<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org/">
<head th:replace="~{fragments :: head}">
</head>
<link rel="stylesheet" th:href="@{/css/page-product.css}">
<body>

<!--header-->
<header th:replace="~{fragments :: header}"></header>

<div class="container page-product my-5 py-5">
    <div class="head-page-product w-100 ">
        <div>
            <h1 style="font-weight: 900" th:text="${nameCategory}"></h1>
            <hr>
        </div>
        <div class="detail-category">

            <div class="head-detail-category  ">
                <ul class="list-category d-flex align-items-center">
                    <li th:each="category : ${categories}">
                        <a th:href="@{'products?' +
                           'page=' + ${currentPage} +
                           '&idCategory=' + ${category.id} +
                           ${keyword != null && keyword != '' ? ' &keyword=' + keyword : ''} +
                           ${sort != null && sort != '' ? '&sortPrice=' + sort : ''} +
                           ${minPrice != null && maxPrice != null ? '&priceCdt=' + minPrice + ':' + maxPrice : '' } +
                           ${sizeChoose != null && sizeChooseString != null ? '&bySize=' + sizeChooseString : ''}}"
                           th:text="${category.name}"></a></li>
                </ul>

                <form class="form-search-product " th:action="'products?' +
                    'page=' + ${currentPage} +
                    '&idCategory=' + ${idCategory} +
                    ${sort != null && sort != '' ? '&sortPrice=' + sort : ''} +
                    ${minPrice != null && maxPrice != null ? '&priceCdt=' + minPrice + ':' + maxPrice : '' }+
                    ${sizeChoose != null && sizeChooseString != null ? '&bySize=' + sizeChooseString : ''} +
                    ${keyword != null && keyword != '' ? ' &keyword=' + keyword : ''} ">
                    <div style="display: inline-block"
                         class="parent-input-search-product md-form active-purple active-purple-2 mb-3">
                        <input class="form-control" aria-label="Search Product" name="keyword"
                               placeholder="Search Product" type="text">
                    </div>
                    <button type="submit" class="btn-search-product"><i class="fa-solid fa-magnifying-glass"></i>
                    </button>
                </form>
            </div>
            <select id="sort-by" onchange="window.location=this.options[this.selectedIndex].value">
                <option th:replace="~{fragments :: sort('news', 'Latest')}"></option>

                <option class="option-sort option-sort-most " th:value="''">Buy the most</option>

                <option th:replace="~{fragments :: sort('true', 'Prices gradually increase')}"></option>
                <option th:replace="~{fragments :: sort('false', 'Prices gradually decrease')}"></option>

            </select>

        </div>
    </div>

    <div class="row-products row ">
        <div class="left-page-product my-5 d-none d-lg-block">
            <h5 class="">FILTER</h5>
            <div class="filter-by filter-by-price">

                <ul>
                    <li>By Price</li>
                    <li>
                        <a th:replace="~{fragments :: filterPrice(0, 300000, 'Under 300.000đ')}"></a>

                    </li>
                    <li>
                        <a th:replace="~{fragments :: filterPrice(300000, 500000, '300.000đ - 500.000đ')}"></a>
                    </li>
                    <li>
                        <a th:replace="~{fragments :: filterPrice(500000, 1000000, '500.000đ - 1.000.000đ')}"></a>
                    </li>
                    <li>
                        <a th:replace="~{fragments :: filterPrice(1000000, 3000000, '1.000.000đ - 3.000.000đ')}"></a>
                    </li>
                    <li>
                        <a th:replace="~{fragments :: filterPrice(3000000, 999999999, 'On 3.000.000đ')}"></a>
                    </li>


                </ul>
            </div>
            <hr>
            <div class="filter-by filter-by-size">
                <ul>
                    <li>By Size</li>
                    <li>
                        <a th:replace="~{fragments :: filterSizes(1, 0, 'S')}"></a>
                    </li>
                    <li>
                        <a th:replace="~{fragments :: filterSizes(2, 0, 'M')}"></a>
                    </li>
                    <li>
                        <a th:replace="~{fragments :: filterSizes(3, 0, 'L')}"></a>
                    </li>
                    <li>
                        <a th:replace="~{fragments :: filterSizes(4, 0, 'XL')}"></a>
                    </li>

                </ul>
            </div>
            <hr>
            <div class="filter-by filter-by-brand">
                <ul>
                    <li>By Brand</li>
                    <li>
                    <span>
                        <label for="filter-by-brand-1"></label>
                        <input type="checkbox" name="filter-by-price-1" id="filter-by-brand-1">
                        Nike
                    </span>
                    </li>
                    <li>
                    <span>
                        <label for="filter-by-brand-2"></label>
                        <input type="checkbox" name="filter-by-price-1" id="filter-by-brand-2">
                        Adidas
                    </span>
                    </li>
                    <li>
                    <span>
                        <label for="filter-by-brand-3"></label>
                        <input type="checkbox" name="filter-by-price-1" id="filter-by-brand-3">
                        Catoste
                    </span>
                    </li>
                    <li>
                    <span>
                        <label for="filter-by-brand-4"></label>
                        <input type="checkbox" name="filter-by-price-1" id="filter-by-brand-4">
                        Levi's
                    </span>
                    </li>
                    <li>
                    <span>
                        <label for="filter-by-brand-5"></label>
                        <input type="checkbox" name="filter-by-price-1" id="filter-by-brand-5">
                        Puma
                    </span>
                    </li>
                </ul>
            </div>
        </div>

        <div class="right-page-product my-5 ">
            <div class="current-row-products row d-flex justify-content-around">
                <div th:if="${products.isEmpty()}">
                    <div class="alert alert-warning">No suitable products were found</div>
                </div>

                <div class="card border-0  col-6 col-sm-6 col-lg-4 " style="cursor: pointer; padding-bottom: 40px"
                     th:each="product, obj : ${products}">
                    <a th:href="@{/product-detail/{id}(id = ${product.id})}">
                        <div class="card__main" style="">
                            <div class="img__product">
                                <img class="front-img "
                                     th:src="'data:image/jpeg;base64,' + ${product.images.get(0).image}"
                                     alt="">
                                <img class="back-img"
                                     th:src="'data:image/jpeg;base64,' + ${product.images.get(1).image}"
                                     alt="">

                                <div class="card__main--choose-options">
                                    <div class="buy-now"><a href="#" style="text-decoration: none; color: white;">MUA
                                        NGAY</a>
                                    </div>
                                    <div class="add-to-cart"><a href="#" style="text-decoration: none; color: white;">THÊM
                                        VÀO
                                        GIỎ
                                        HÀNG</a></div>
                                </div>
                            </div>
                        </div>
                        <div class="card__name-price">
                            <div class="name-product" th:text="${product.name}"></div>
                            <div class="price-product" th:text="${product.costPrice}"></div>
                        </div>
                    </a>
                </div>
            </div>


            <nav class="pagination-parent" aria-label="Page navigation example">
                <ul class="pagination justify-content-center   ">
                    <li class="page-item"><a th:replace="~{fragments :: paging(0, 'First page')}"></a></li>
                    <li class="page-item" th:if="${currentPage != 0}">
                        <a
                                th:replace="~{fragments :: paging(${currentPage - 1}, '&laquo;')}"
                                class="page-link" aria-label="Previous">
                            <span aria-hidden="true" style="color: #858E96">&laquo;</span>
                            <span class="sr-only">Previous</span>
                        </a>
                    </li>
                    <!--                    <li th:if="${currentPage - 2 > 1}" class="page-item"><a class="page-link" style="color: #858E96"-->
                    <!--                                                                            href="#">...</a></li>-->
                    <li th:each="i : ${#numbers.sequence(1, totalPage)}"
                        th:classappend="${currentPage == i - 1 ? 'active' : ''}"
                        class="page-item">
                        <a th:replace="~{fragments :: paging(${i - 1}, ${i})}"></a>
                    </li>
                    <!--                    <li th:if="${currentPage + 2 > totalPage}" class="page-item"><a class="page-link"-->
                    <!--                                                                                    style="color: #858E96" href="#">...</a>-->
                    <!--                    </li>-->

                    <li class="page-item" th:if="${currentPage + 1 != totalPage}">
                        <a th:replace="~{fragments :: paging(${currentPage + 1}, '&raquo;')}"
                           class="page-link" aria-label="Next">
                            <span aria-hidden="true" style="color: #858E96">&raquo;</span>
                            <span class="sr-only">Next</span>
                        </a>
                    </li>
                    <li class="page-item"><a th:replace="~{fragments :: paging(${totalPage - 1}, 'Last page')}"></a>
                    </li>
                </ul>
            </nav>

        </div>


    </div>
</div>


<!--footer-->
<footer th:replace="~{fragments :: footer}"></footer>

<div th:replace="~{fragments :: scroll}"></div>

<div th:replace="~{fragments :: script}"></div>

<script th:src="@{/js/page-product.js}"></script>

</body>
</html>